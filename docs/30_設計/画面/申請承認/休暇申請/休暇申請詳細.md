# 休暇申請詳細

## 概要

| 項目 | 内容 |
|------|------|
| 画面ID | SCR-LV-002 |
| 画面種別 | 詳細 |
| 関連集約 | 休暇申請（申請承認コンテキスト） |
| URL | `/leave-requests/{id}` |

---

## ワイヤーフレーム

### SUBMITTED 状態（上長が閲覧時）

```
┌───────────────────────────────────────────────────────────────────────────┐
│ {システム名}                                                  [user ▼]   │
├───────────────────────────────────────────────────────────────────────────┤
│ パンくず: ホーム > 申請管理 > 休暇申請一覧 > 休暇申請詳細               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│ 休暇申請詳細                                          [申請中]          │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 申請情報                                                           │ │
│ │                                                                   │ │
│ │ 休暇種別         年次有給                                         │ │
│ │ 取得期間         2026/02/16 (月) 〜 2026/02/17 (火)               │ │
│ │ 申請理由         ―                                                │ │
│ │ 申請日時         2026/02/10 09:00                                  │ │
│ │ 申請者           山田太郎 (EMP-001)                                │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 承認/却下                                                         │ │
│ │                                                                   │ │
│ │ 却下理由  [                                               ]       │ │
│ │           ※却下する場合のみ入力 (10-200文字)                       │ │
│ │                                                                   │ │
│ │                              [却下する]  [■ 承認する ■]           │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 操作履歴                                                           │ │
│ │                                                                   │ │
│ │ 2026/02/10 09:00  山田太郎  申請                                   │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ [← 一覧に戻る]                                                         │
│                                                                         │
└───────────────────────────────────────────────────────────────────────────┘
```

### SUBMITTED 状態（申請者本人が閲覧時）

```
┌───────────────────────────────────────────────────────────────────────────┐
│ {システム名}                                                  [user ▼]   │
├───────────────────────────────────────────────────────────────────────────┤
│ パンくず: ホーム > 申請管理 > 休暇申請一覧 > 休暇申請詳細               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│ 休暇申請詳細                                          [申請中]          │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 申請情報                                                           │ │
│ │                                                                   │ │
│ │ 休暇種別         時間休                                           │ │
│ │ 取得期間         2026/02/12 (木)                                   │ │
│ │ 取得時間帯       10:00 〜 12:00                                    │ │
│ │ 申請理由         ―                                                │ │
│ │ 申請日時         2026/02/10 09:30                                  │ │
│ │ 申請者           山田太郎 (EMP-001)                                │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 取り消し                                                           │ │
│ │                                                                   │ │
│ │                                          [取り消す]               │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 操作履歴                                                           │ │
│ │                                                                   │ │
│ │ 2026/02/10 09:30  山田太郎  申請                                   │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ [← 一覧に戻る]                                                         │
│                                                                         │
└───────────────────────────────────────────────────────────────────────────┘
```

### APPROVED 状態（閲覧のみ）

```
┌───────────────────────────────────────────────────────────────────────────┐
│ {システム名}                                                  [user ▼]   │
├───────────────────────────────────────────────────────────────────────────┤
│ パンくず: ホーム > 申請管理 > 休暇申請一覧 > 休暇申請詳細               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│ 休暇申請詳細                                          [承認済]          │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 申請情報                                                           │ │
│ │                                                                   │ │
│ │ 休暇種別         午前半休                                         │ │
│ │ 取得期間         2026/02/14 (土)                                   │ │
│ │ 申請理由         ―                                                │ │
│ │ 申請日時         2026/02/10 10:00                                  │ │
│ │ 申請者           山田太郎 (EMP-001)                                │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 承認情報                                                           │ │
│ │                                                                   │ │
│ │ 承認者           鈴木部長 (MGR-001)                                │ │
│ │ 承認日時         2026/02/10 14:00                                  │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 操作履歴                                                           │ │
│ │                                                                   │ │
│ │ 2026/02/10 14:00  鈴木部長  承認                                   │ │
│ │ 2026/02/10 10:00  山田太郎  申請                                   │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ [← 一覧に戻る]                                                         │
│                                                                         │
└───────────────────────────────────────────────────────────────────────────┘
```

### REJECTED 状態（閲覧のみ）

```
┌───────────────────────────────────────────────────────────────────────────┐
│ {システム名}                                                  [user ▼]   │
├───────────────────────────────────────────────────────────────────────────┤
│ パンくず: ホーム > 申請管理 > 休暇申請一覧 > 休暇申請詳細               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│ 休暇申請詳細                                            [却下]          │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 申請情報                                                           │ │
│ │                                                                   │ │
│ │ 休暇種別         慶弔休暇                                         │ │
│ │ 取得期間         2026/02/20 (金) 〜 2026/02/24 (火)               │ │
│ │ 申請理由         親族の葬儀に参列するため                         │ │
│ │ 申請日時         2026/02/18 08:00                                  │ │
│ │ 申請者           山田太郎 (EMP-001)                                │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 却下情報                                                           │ │
│ │                                                                   │ │
│ │ 却下者           鈴木部長 (MGR-001)                                │ │
│ │ 却下理由         慶弔休暇の取得には証明書の添付が必要です。       │ │
│ │                  証明書を準備のうえ再申請してください。             │ │
│ │ 却下日時         2026/02/18 10:00                                  │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 操作履歴                                                           │ │
│ │                                                                   │ │
│ │ 2026/02/18 10:00  鈴木部長  却下                                   │ │
│ │ 2026/02/18 08:00  山田太郎  申請                                   │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ [← 一覧に戻る]                                                         │
│                                                                         │
└───────────────────────────────────────────────────────────────────────────┘
```

### CANCELLED 状態（閲覧のみ）

```
┌───────────────────────────────────────────────────────────────────────────┐
│ {システム名}                                                  [user ▼]   │
├───────────────────────────────────────────────────────────────────────────┤
│ パンくず: ホーム > 申請管理 > 休暇申請一覧 > 休暇申請詳細               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│ 休暇申請詳細                                          [取消済]          │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 申請情報                                                           │ │
│ │                                                                   │ │
│ │ 休暇種別         年次有給                                         │ │
│ │ 取得期間         2026/02/16 (月) 〜 2026/02/17 (火)               │ │
│ │ 申請理由         ―                                                │ │
│ │ 申請日時         2026/02/10 09:00                                  │ │
│ │ 申請者           山田太郎 (EMP-001)                                │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 取消情報                                                           │ │
│ │                                                                   │ │
│ │ 取消日時         2026/02/10 11:00                                  │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ 操作履歴                                                           │ │
│ │                                                                   │ │
│ │ 2026/02/10 11:00  山田太郎  取消                                   │ │
│ │ 2026/02/10 09:00  山田太郎  申請                                   │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│ [← 一覧に戻る]                                                         │
│                                                                         │
└───────────────────────────────────────────────────────────────────────────┘
```

---

## コンポーネント構成

```
LeaveRequestDetailPage
├── Breadcrumb
│   └── BreadcrumbItem ("ホーム", "申請管理", "休暇申請一覧", "休暇申請詳細")
├── PageHeader
│   ├── Title ("休暇申請詳細")
│   └── StatusBadge (現在のステータス)
├── RequestInfoSection
│   ├── DefinitionList
│   │   ├── LeaveType (休暇種別)
│   │   ├── LeavePeriod (取得期間)
│   │   ├── TimeSlot (取得時間帯, HOURLY のみ表示)
│   │   ├── Reason (申請理由, 特別休暇時のみ値あり)
│   │   ├── SubmittedAt (申請日時)
│   │   └── EmployeeName (申請者)
├── ApprovalSection (SUBMITTED + 上長のみ表示)
│   ├── RejectionReasonInput (却下理由テキストエリア)
│   └── ButtonGroup
│       ├── RejectButton (却下する)
│       └── ApproveButton (承認する)
├── CancelSection (SUBMITTED + 申請者本人のみ表示)
│   └── CancelButton (取り消す)
├── RejectionInfoSection (REJECTED のみ表示)
│   ├── DefinitionList
│   │   ├── ApproverName (却下者)
│   │   ├── RejectionReason (却下理由)
│   │   └── DecidedAt (却下日時)
├── ApprovalInfoSection (APPROVED のみ表示)
│   ├── DefinitionList
│   │   ├── ApproverName (承認者)
│   │   └── DecidedAt (承認日時)
├── CancelInfoSection (CANCELLED のみ表示)
│   ├── DefinitionList
│   │   └── DecidedAt (取消日時)
├── OperationHistory
│   └── HistoryList
│       └── HistoryItem (日時 + 操作者 + 操作)
├── BackLink ("← 一覧に戻る")
└── ToastNotification (操作結果通知)
```

---

## 表示項目

### 申請情報

| 項目 | 表示名 | 型 | フォーマット | 備考 |
|------|--------|-----|-------------|------|
| leaveType | 休暇種別 | enum | 表示名変換（下表参照） | - |
| leavePeriod | 取得期間 | dateRange | YYYY/MM/DD (曜) 〜 YYYY/MM/DD (曜) | 1日の場合は開始日のみ |
| timeSlot | 取得時間帯 | timeRange | HH:mm 〜 HH:mm | HOURLY のみ表示 |
| reason | 申請理由 | text | - | 特別休暇時のみ値あり、未入力時「―」 |
| submittedAt | 申請日時 | datetime | YYYY/MM/DD HH:mm | - |
| employeeName | 申請者 | text | 氏名 (社員ID) | - |

### 休暇種別の表示変換

| 値 | 表示名 |
|----|--------|
| ANNUAL | 年次有給 |
| HALF_DAY_AM | 午前半休 |
| HALF_DAY_PM | 午後半休 |
| HOURLY | 時間休 |
| SPECIAL_CONDOLENCE | 慶弔休暇 |
| SPECIAL_REFRESH | リフレッシュ休暇 |

### 承認/却下/取消情報（決定済みの場合）

| 項目 | 表示名 | 型 | フォーマット | 備考 |
|------|--------|-----|-------------|------|
| approverName | 承認者/却下者 | text | 氏名 (管理者ID) | APPROVED/REJECTED のみ |
| rejectionReason | 却下理由 | text | - | REJECTED のみ |
| decidedAt | 承認日時/却下日時/取消日時 | datetime | YYYY/MM/DD HH:mm | - |

### ステータスバッジ

| 値 | 表示 | 色 | 背景色 |
|----|------|-----|--------|
| SUBMITTED | 申請中 | blue-700 | blue-100 |
| APPROVED | 承認済 | green-700 | green-100 |
| REJECTED | 却下 | red-700 | red-100 |
| CANCELLED | 取消済 | gray-700 | gray-100 |

---

## アクション

### 条件付きアクションセクション

| アクション | トリガー | 表示条件 | 処理 | 権限 |
|-----------|---------|---------|------|------|
| 承認する | 承認ボタン | status=SUBMITTED | approve API 実行 → ステータス更新 | 上長のみ |
| 却下する | 却下ボタン | status=SUBMITTED | reject API 実行（却下理由必須） → ステータス更新 | 上長のみ |
| 取り消す | 取り消しボタン | status=SUBMITTED | cancel API 実行 → ステータス更新 | 申請者本人のみ |
| 一覧に戻る | 戻るリンク | 常時 | 休暇申請一覧 (SCR-LV-001) へ遷移 | 全ロール |

### 確認ダイアログ

| アクション | ダイアログ | メッセージ |
|-----------|----------|-----------|
| 承認する | 確認ダイアログ | 「この休暇申請を承認しますか？」 |
| 却下する | 確認ダイアログ | 「この休暇申請を却下しますか？」（却下理由入力必須） |
| 取り消す | 確認ダイアログ | 「この休暇申請を取り消しますか？取り消し後は再申請が必要です」 |

---

## 状態管理

```typescript
/** 申請ステータス */
type LeaveRequestStatus =
  | 'SUBMITTED'
  | 'APPROVED'
  | 'REJECTED'
  | 'CANCELLED';

/** 休暇種別 */
type LeaveType =
  | 'ANNUAL'
  | 'HALF_DAY_AM'
  | 'HALF_DAY_PM'
  | 'HOURLY'
  | 'SPECIAL_CONDOLENCE'
  | 'SPECIAL_REFRESH';

/** 休暇申請詳細データ */
interface LeaveRequestDetail {
  requestId: string;               // 休暇申請ID
  employeeId: string;
  employeeName: string;            // 従業員マスタから導出
  leaveType: LeaveType;
  leavePeriod: {
    from: string;                  // ISO 8601 date
    to: string;                    // ISO 8601 date
  };
  timeSlot: {
    startTime: string;             // HH:mm
    endTime: string;               // HH:mm
  } | null;                        // HOURLY のみ、他はnull
  reason: string | null;           // 特別休暇時のみ
  status: LeaveRequestStatus;
  approverId: string | null;
  approverName: string | null;     // 従業員マスタから導出
  approvedAt: string | null;       // ISO 8601 datetime
  rejectionReason: string | null;
  rejectedAt: string | null;       // ISO 8601 datetime
  cancelledAt: string | null;      // ISO 8601 datetime
  submittedAt: string;             // ISO 8601 datetime
  operationHistory: OperationHistoryItem[];
}

/** 操作履歴 */
interface OperationHistoryItem {
  action: string;                  // SUBMITTED / APPROVED / REJECTED / CANCELLED
  performedBy: string;             // 操作者ID
  performedByName: string;         // 操作者名（従業員マスタから導出）
  performedAt: string;             // ISO 8601 datetime
  comment: string | null;          // コメント（却下理由等）
}

/** 画面全体の状態 */
interface LeaveRequestDetailState {
  /** 詳細データ */
  data: {
    request: LeaveRequestDetail | null;
    history: OperationHistoryItem[];
    isLoading: boolean;
    error: {
      message: string;
      retryAction: (() => void) | null;
    } | null;
  };

  /** 承認/却下セクション（上長のみ） */
  approvalSection: {
    rejectionReason: string;       // 却下理由入力値
    isSubmitting: boolean;
  };

  /** 確認ダイアログ */
  confirmDialog: {
    isOpen: boolean;
    action: 'approve' | 'reject' | 'cancel' | null;
  };
}
```

---

## API連携

| 操作 | エンドポイント | メソッド | パラメータ |
|------|--------------|---------|-----------|
| 詳細取得 | `/api/v1/leave-requests/{id}` | GET | - |
| 承認 | `/api/v1/leave-requests/{id}/actions/approve` | POST | approverId |
| 却下 | `/api/v1/leave-requests/{id}/actions/reject` | POST | approverId, rejectionReason |
| 取り消し | `/api/v1/leave-requests/{id}/actions/cancel` | POST | - |

---

## エラー処理

| エラー | HTTPステータス | 表示方法 | アクション |
|--------|--------------|---------|----------|
| 通信エラー | - | Toast (error) | 再試行ボタン |
| 認証エラー | 401 | リダイレクト | ログイン画面へ |
| 権限エラー | 403 | Toast (error) | 「この操作を行う権限がありません」 |
| 申請不存在 | 404 | Toast (error) + リダイレクト | 一覧画面へ |
| 状態不整合 | 409 | Toast (warning) | 「申請の状態が変更されています」 + 再取得 |
| バリデーションエラー | 400 | フォーム内エラー表示 | 各フィールド下にエラーメッセージ |
| サーバーエラー | 500 | Toast (error) | 再試行ボタン |

---

## レスポンシブ対応

| ブレークポイント | 対応 |
|----------------|------|
| Desktop (>1024px) | フル表示（セクション横並びなし、縦積み） |
| Tablet (768-1024px) | 同上（レイアウト変更なし） |
| Mobile (<768px) | パディング縮小、ボタン幅 100% |

---

## デザインガイドライン

> aesthetic: `clean-minimal` / colorScheme: `mono-accent`

### カラー＆テーマ

| 項目 | 値 | 備考 |
|------|-----|------|
| ベースカラー | #FFFFFF | ページ背景 |
| サーフェスカラー | #F9FAFB (gray-50) | セクション背景 |
| テキスト: Primary | #111827 (gray-900) | 見出し・データ値 |
| テキスト: Secondary | #6B7280 (gray-500) | ラベル・補足 |
| ボーダー | #E5E7EB (gray-200) | セクション区切り |
| アクセントカラー | #2563EB (blue-600) | Primary ボタン（承認） |
| Danger カラー | #DC2626 (red-600) | 却下ボタン |
| Warning カラー | #D97706 (amber-600) | 取り消しボタン |
| バッジ: 申請中 | blue-100 / blue-700 | SUBMITTED |
| バッジ: 承認済 | green-100 / green-700 | APPROVED |
| バッジ: 却下 | red-100 / red-700 | REJECTED |
| バッジ: 取消済 | gray-100 / gray-700 | CANCELLED |
| コントラスト比 | WCAG AA 準拠（4.5:1 以上） | テキスト/背景 |

### タイポグラフィ

| 要素 | フォント | サイズ | ウェイト | 備考 |
|------|---------|--------|---------|------|
| ページタイトル | system-ui | 24px | 700 | パンくず下 |
| セクション見出し | system-ui | 18px | 600 | 申請情報・承認情報等 |
| 定義リスト: ラベル | system-ui | 12px | 500 | 「休暇種別」等 |
| 定義リスト: 値 | system-ui | 14px | 400 | データ値 |
| 時刻表示 | monospace | 14px | 400 | 日時データ |
| ボタンラベル | system-ui | 14px | 500 | 承認・却下・取り消し |
| 履歴テキスト | system-ui | 13px | 400 | 操作履歴行 |

### レイアウト原則

| 項目 | 値 |
|------|-----|
| 基本余白 | 8px グリッド |
| ページ左右パディング | 24px |
| セクション: パディング | 20px |
| セクション: 角丸 | 8px |
| セクション: ボーダー | 1px solid #E5E7EB |
| セクション間余白 | 20px |
| 定義リスト: ラベル幅 | 140px |
| 定義リスト: 行間 | 12px |
| ボタン角丸 | 6px |
| ボタン高さ | 40px |
| 区切り線 | 1px solid #E5E7EB |

### インタラクション

| 状態 | スタイル |
|------|---------|
| ボタン: ホバー | 背景色 5% 暗く |
| ボタン: disabled | opacity: 0.4 |
| ボタン: 送信中 | スピナー表示、全ボタン disabled |
| フォーカス | 2px outline (blue-600) + 2px offset |
| 確認ダイアログ | 中央モーダル（オーバーレイ付き） |
| ローディング | Skeleton UI（セクション単位） |
| 画面遷移 | 即時（アニメーションなし） |
| フィードバック | Toast 通知（右上、3秒自動消去） |

### アンチパターン（避けるべき表現）

- グラデーション背景の多用
- 装飾的なドロップシャドウの重ね掛け
- 無意味なアニメーション・トランジション
- ジェネリックなAI生成風のイラスト
- 過度な角丸（pill 形状の乱用）
- アクションボタンの配置を状態によって移動させる（固定位置が望ましい）

---

## 品質チェック結果

- [x] 全クエリに対応する表示要素がある（申請情報・承認情報・却下情報・取消情報・操作履歴の全項目を表示）
- [x] 全コマンドに対応する操作UIがある（承認・却下・取り消しの3アクション + 確認ダイアログ）
- [x] エラー状態の表示が定義されている（Toast通知 + 再試行、状態不整合時の再取得）
- [x] 状態遷移がUI上で表現されている（ステータスバッジ + 状態別セクション表示切替）
- [x] 条件付き表示がカバーされている（HOURLY時のtimeSlot表示、特別休暇時のreason表示）
- [x] 5状態パターンのワイヤーフレームが揃っている（SUBMITTED×上長、SUBMITTED×本人、APPROVED、REJECTED、CANCELLED）

<!-- メトリクスサマリー（/estimate 自動集計用）
画面種別: 詳細
コンポーネント数: 22
DataTable: 0
SearchForm: 0
フォーム数: 1
チャート数: 0
-->
