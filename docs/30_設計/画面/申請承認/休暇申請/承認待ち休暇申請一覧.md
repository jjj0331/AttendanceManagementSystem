# 承認待ち休暇申請一覧

## 概要

| 項目 | 内容 |
|------|------|
| 画面ID | SCR-LV-004 |
| 画面種別 | 一覧 |
| 関連集約 | 休暇申請（申請承認コンテキスト） |
| URL | `/leave-requests/pending-approvals` |

---

## ワイヤーフレーム

```
┌───────────────────────────────────────────────────────────────────────────┐
│ {システム名}                                                  [user ▼]   │
├───────────────────────────────────────────────────────────────────────────┤
│ パンくず: ホーム > 申請管理 > 承認待ち休暇申請一覧                       │
├───────────────────────────────────────────────────────────────────────────┤
│ ┌───────────────────────────────────────────────────────────────────────┐ │
│ │ 検索条件                                                             │ │
│ │                                                                     │ │
│ │ 申請者   [             ]                                             │ │
│ │ 休暇種別 [全件           ▼]                                          │ │
│ │ 取得期間 [2026/02/01] ～ [2026/02/28]                               │ │
│ │                                                                     │ │
│ │                                          [クリア]  [■ 検索 ■]       │ │
│ └───────────────────────────────────────────────────────────────────────┘ │
├───────────────────────────────────────────────────────────────────────────┤
│ 承認待ち: 3件                                                           │
├───────────────────────────────────────────────────────────────────────────┤
│ ┌──────────┬──────────┬──────────────┬────────────────────┬──────────┐  │
│ │ 申請者 ▼ │ 休暇種別 │ 取得期間 ▼   │ 申請理由           │ 申請日 ▼ │  │
│ ├──────────┼──────────┼──────────────┼────────────────────┼──────────┤  │
│ │ 佐藤花子 │ 年次有給 │ 02/14        │ −                  │ 02/10    │  │
│ │ 田中一郎 │ 慶弔休暇 │ 02/15〜02/17 │ 祖母逝去のため     │ 02/10    │  │
│ │ 高橋美咲 │ 午前半休 │ 02/12        │ −                  │ 02/09    │  │
│ └──────────┴──────────┴──────────────┴────────────────────┴──────────┘  │
├───────────────────────────────────────────────────────────────────────────┤
│ < 1 2 3 >                                             20件/ページ ▼    │
└───────────────────────────────────────────────────────────────────────────┘
```

---

## コンポーネント構成

```
PendingLeaveApprovalListPage
├── Breadcrumb
│   └── BreadcrumbItem ("ホーム", "申請管理", "承認待ち休暇申請一覧")
├── SearchForm (上部固定)
│   ├── TextInput (申請者名 ※部分一致)
│   ├── SelectBox (休暇種別 ※全件/年次有給/午前半休/午後半休/時間休/慶弔休暇/リフレッシュ休暇)
│   ├── DateRangePicker (取得期間)
│   └── ButtonGroup
│       ├── ClearButton (クリア)
│       └── SearchButton (検索)
├── ActionBar
│   └── ResultCount ("承認待ち: {N}件")
├── DataTable
│   ├── TableHeader (ソート可: 申請者, 取得期間, 申請日)
│   ├── TableRow (クリックで休暇申請詳細画面へ遷移)
│   │   ├── EmployeeNameCell (申請者名)
│   │   ├── LeaveTypeCell (休暇種別 ※表示名変換)
│   │   ├── LeavePeriodCell (取得期間 ※単日/範囲の出し分け)
│   │   ├── ReasonCell (申請理由 ※特別休暇のみ表示、それ以外は "−")
│   │   └── SubmittedAtCell (申請日)
│   └── EmptyState ("承認待ちの休暇申請はありません")
└── Pagination
    ├── PageNumbers
    └── PageSizeSelector (20件/ページ)
```

---

## 表示項目

### 一覧カラム

| カラム | 表示名 | 型 | ソート | 幅 | 備考 |
|--------|--------|-----|--------|------|------|
| employeeName | 申請者 | text | ✅ | 120px | 氏名 |
| leaveType | 休暇種別 | badge | - | 100px | Enum→表示名変換 |
| leavePeriod | 取得期間 | date | ✅ (デフォルト昇順) | 140px | 単日: MM/DD / 範囲: MM/DD〜MM/DD |
| reason | 申請理由 | text | - | auto | 特別休暇のみ表示、それ以外は "−" |
| submittedAt | 申請日 | date | ✅ | 100px | MM/DD 形式 |

### 休暇種別の表示名変換

| Enum値 | 表示名 | 備考 |
|--------|--------|------|
| ANNUAL | 年次有給 | - |
| HALF_DAY_AM | 午前半休 | - |
| HALF_DAY_PM | 午後半休 | - |
| HOURLY | 時間休 | - |
| SPECIAL_CONDOLENCE | 慶弔休暇 | 理由表示あり |
| SPECIAL_REFRESH | リフレッシュ休暇 | 理由表示あり |

### 申請理由の表示ルール

| 条件 | 表示内容 |
|------|---------|
| leaveType が `SPECIAL_CONDOLENCE` または `SPECIAL_REFRESH` | reason をそのまま表示（30文字+...で省略） |
| 上記以外 | "−"（ハイフン） |

---

## 検索条件

| 条件 | フィールド名 | 入力形式 | 演算子 | デフォルト | 備考 |
|------|-------------|---------|--------|-----------|------|
| 申請者 | employeeName | テキスト | 部分一致 (LIKE) | − | 氏名で絞り込み |
| 休暇種別 | leaveType | セレクト（単一） | = | 全件 | 全件/ANNUAL/HALF_DAY_AM/HALF_DAY_PM/HOURLY/SPECIAL_CONDOLENCE/SPECIAL_REFRESH |
| 取得期間 | leavePeriod | 日付範囲 (DateRange) | BETWEEN | 当月 (1日〜末日) | カレンダーピッカー |

> 承認待ち一覧はログインユーザー（上長）の部下の申請に自動フィルタされる。
> 社員選択フィルタは不要（API側で自動制御）。

---

## アクション

### 画面アクション

| アクション | トリガー | 処理 | 権限 |
|-----------|---------|------|------|
| 検索 | 検索ボタン | 検索条件で一覧再取得 | read (管理職) |
| クリア | クリアボタン | 検索条件をデフォルトに戻す | read |
| ソート変更 | カラムヘッダークリック | ソート条件変更 + 一覧再取得 | read |
| ページ切替 | ページネーション操作 | ページ変更 + 一覧再取得 | read |

### 行アクション

| アクション | 処理 | 備考 |
|-----------|------|------|
| 行クリック | 休暇申請詳細画面 (SCR-LV-002) へ遷移 | 詳細画面で承認・却下を実行 |

---

## 状態管理

```typescript
/** ソート方向 */
type SortOrder = 'asc' | 'desc';

/** ソート可能カラム */
type SortableColumn =
  | 'employeeName'
  | 'leavePeriod'
  | 'submittedAt';

/** 休暇種別 */
type LeaveType =
  | 'ANNUAL'
  | 'HALF_DAY_AM'
  | 'HALF_DAY_PM'
  | 'HOURLY'
  | 'SPECIAL_CONDOLENCE'
  | 'SPECIAL_REFRESH';

/** 承認待ち休暇申請アイテム */
interface PendingLeaveRequestItem {
  requestId: string;                 // 休暇申請ID
  employeeId: string;
  employeeName: string;              // 従業員マスタから導出
  leaveType: LeaveType;
  leavePeriod: {
    from: string;                    // ISO 8601 date
    to: string;                      // ISO 8601 date
  };
  reason: string | null;             // 特別休暇の場合のみ
  submittedAt: string;               // ISO 8601 datetime
}

/** 検索パラメータ */
interface SearchParams {
  employeeName: string | null;       // 部分一致、デフォルト: null
  leaveType: LeaveType | null;       // デフォルト: null (全件)
  dateFrom: string;                  // ISO 8601 date、デフォルト: 当月1日
  dateTo: string;                    // ISO 8601 date、デフォルト: 当月末日
}

/** ページネーション */
interface PaginationState {
  page: number;                      // 現在ページ (0-based)
  size: number;                      // 1ページあたり件数 (デフォルト: 20)
  sort: SortableColumn;              // ソートカラム (デフォルト: submittedAt)
  order: SortOrder;                  // ソート方向 (デフォルト: asc)
}

/** 画面全体の状態 */
interface PendingLeaveApprovalListState {
  /** 検索条件 */
  searchParams: SearchParams;

  /** ページネーション */
  pagination: PaginationState;

  /** データ */
  data: {
    content: PendingLeaveRequestItem[];
    page: {
      number: number;
      size: number;
      totalElements: number;
      totalPages: number;
    };
    isLoading: boolean;
    error: {
      message: string;
      retryAction: (() => void) | null;
    } | null;
  };
}
```

---

## API連携

| 操作 | エンドポイント | メソッド | パラメータ |
|------|--------------|---------|-----------|
| 承認待ち一覧取得 | `/api/v1/leave-requests/pending-approvals` | GET | employeeName, leaveType, dateFrom, dateTo, page, size, sort |

### リクエスト例

```
GET /api/v1/leave-requests/pending-approvals
  ?employeeName=佐藤
  &leaveType=ANNUAL
  &dateFrom=2026-02-01
  &dateTo=2026-02-28
  &page=0
  &size=20
  &sort=submittedAt,asc
```

### レスポンス例

```json
{
  "content": [
    {
      "requestId": "LVR-20260210-EMP002",
      "employeeId": "EMP-002",
      "employeeName": "佐藤花子",
      "leaveType": "ANNUAL",
      "leavePeriod": {
        "from": "2026-02-14",
        "to": "2026-02-14"
      },
      "reason": null,
      "submittedAt": "2026-02-10T09:00:00+09:00"
    },
    {
      "requestId": "LVR-20260210-EMP003",
      "employeeId": "EMP-003",
      "employeeName": "田中一郎",
      "leaveType": "SPECIAL_CONDOLENCE",
      "leavePeriod": {
        "from": "2026-02-15",
        "to": "2026-02-17"
      },
      "reason": "祖母逝去のため",
      "submittedAt": "2026-02-10T09:00:00+09:00"
    }
  ],
  "page": {
    "number": 0,
    "size": 20,
    "totalElements": 3,
    "totalPages": 1
  }
}
```

---

## エラー処理

| エラー | HTTPステータス | 表示方法 | アクション |
|--------|--------------|---------|----------|
| 通信エラー | - | Toast (error) | 再試行ボタン |
| 認証エラー | 401 | リダイレクト | ログイン画面へ |
| 権限エラー | 403 | Toast (error) | 「承認権限がありません」 |
| バリデーションエラー | 400 | Toast (warning) | 検索条件の修正を促す |
| サーバーエラー | 500 | Toast (error) | 再試行ボタン |

---

## レスポンシブ対応

| ブレークポイント | 対応 |
|----------------|------|
| Desktop (>1024px) | フル表示（全5カラム） |
| Tablet (768-1024px) | 申請理由カラム非表示（4カラム） |
| Mobile (<768px) | カード形式に切り替え（申請者+休暇種別+取得期間） |

### Mobile カード形式

```
┌──────────────────────────────────┐
│ 佐藤花子                        │
│ 年次有給  02/14                  │
│ 申請日 02/10                     │
├──────────────────────────────────┤
│ 田中一郎                        │
│ 慶弔休暇  02/15〜02/17           │
│ 祖母逝去のため                  │
│ 申請日 02/10                     │
├──────────────────────────────────┤
│ 高橋美咲                        │
│ 午前半休  02/12                  │
│ 申請日 02/09                     │
└──────────────────────────────────┘
```

---

## デザインガイドライン

> aesthetic: `clean-minimal` / colorScheme: `mono-accent`

### カラー＆テーマ

| 項目 | 値 | 備考 |
|------|-----|------|
| ベースカラー | #FFFFFF | ページ背景 |
| サーフェスカラー | #F9FAFB (gray-50) | 検索フォーム背景 |
| テキスト: Primary | #111827 (gray-900) | 見出し・データ値 |
| テキスト: Secondary | #6B7280 (gray-500) | ラベル・補足 |
| ボーダー | #E5E7EB (gray-200) | テーブル罫線・区切り |
| アクセントカラー | #2563EB (blue-600) | Primary ボタン・ソートアイコン |
| 件数ハイライト | #2563EB (blue-600) | 「承認待ち: 3件」の数字強調 |
| コントラスト比 | WCAG AA 準拠（4.5:1 以上） | テキスト/背景 |

### タイポグラフィ

| 要素 | フォント | サイズ | ウェイト | 備考 |
|------|---------|--------|---------|------|
| ページタイトル | system-ui | 24px | 700 | パンくず下 |
| 検索ラベル | system-ui | 12px | 500 | 検索条件ラベル |
| テーブルヘッダー | system-ui | 12px | 600 | カラム名 |
| テーブルデータ | system-ui | 14px | 400 | セルデータ |
| 日付表示 | monospace | 14px | 400 | MM/DD 形式を等幅で |
| 件数表示 | system-ui | 14px | 600 | 「承認待ち: 3件」 |
| ボタンラベル | system-ui | 14px | 500 | 検索 |

### レイアウト原則

| 項目 | 値 |
|------|-----|
| 基本余白 | 8px グリッド |
| ページ左右パディング | 24px |
| 検索フォーム: パディング | 16px |
| 検索フォーム: 角丸 | 8px |
| セクション間余白 | 16px |
| テーブル行高 | 48px |
| ボタン角丸 | 6px |
| ボタン高さ | 36px |
| カード影 | なし（clean-minimal） |
| 区切り線 | 1px solid #E5E7EB |

### インタラクション

| 状態 | スタイル |
|------|---------|
| テーブル行: ホバー | 背景色 gray-50 + カーソル pointer |
| ソートヘッダー: ホバー | テキスト色 blue-600 + カーソル pointer |
| ソートヘッダー: アクティブ | ▲/▼ アイコン表示 + テキスト色 blue-600 |
| ボタン: ホバー | 背景色 5% 暗く |
| ボタン: disabled | opacity: 0.4 |
| フォーカス | 2px outline (blue-600) + 2px offset |
| ローディング | テーブル部分に Skeleton UI（5行分） |
| 画面遷移 | 即時（アニメーションなし） |
| フィードバック | Toast 通知（右上、3秒自動消去） |
| ページネーション: ホバー | 背景色 gray-100 |
| ページネーション: 現在ページ | 背景色 blue-600 + テキスト白 |

### アンチパターン（避けるべき表現）

- グラデーション背景の多用
- 装飾的なドロップシャドウの重ね掛け
- 無意味なアニメーション・トランジション
- ジェネリックなAI生成風のイラスト
- 過度な角丸（pill 形状の乱用）
- テーブルのゼブラストライプ（clean-minimalでは罫線のみ）
- 検索条件の過度な装飾（シンプルなフォームで十分）

---

## 品質チェック結果

- [x] 全クエリに対応する表示要素がある（5カラムのDataTable、3条件の検索フォーム、ページネーション）
- [x] 全コマンドに対応する操作UIがある（行クリック → 詳細画面 SCR-LV-002 遷移 → 承認/却下アクション）
- [x] エラー状態の表示が定義されている（Toast通知 + 再試行ボタン、権限エラー対応）
- [x] 状態遷移がUI上で表現されている（承認待ち一覧は SUBMITTED のみ表示、行クリックで詳細画面へ）

<!-- メトリクスサマリー（/estimate 自動集計用）
画面種別: 一覧
コンポーネント数: 16
DataTable: 1
SearchForm: 1
フォーム数: 1
チャート数: 0
-->
