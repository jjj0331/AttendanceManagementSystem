# 勤怠管理システム（Kintai） 工数見積もり

## 基本情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | 勤怠管理システム（Kintai） |
| 見積日 | 2026-02-07 |
| 設計書バージョン | Phase 3 + Phase 3.5 完了 |
| 見積もり設定 | docs/.context/estimate-config.yaml |

---

## エグゼクティブサマリー

| 区分 | 工数（人日） |
|------|------------|
| Backend基本工数 | 58.6 |
| Frontend基本工数 | 64.1 |
| **基本工数 合計** | **122.7** |
| スコープ補正（×1.0） | - |
| 品質補正（×1.1） | - |
| チーム補正（×1.0） | - |
| **補正工数** | **134.97** |
| バッファ（20%） | 26.99 |
| **見積総計** | **161.96** |

| 区分 | 金額 |
|------|------|
| 人月換算 | 8.1人月 |
| 人月単価 | 80万円（1人月 = 20日） |
| **見積金額（税抜）** | **¥6,479,000** |

> 金額は1,000円未満切上。

---

## 集約別内訳

| 集約 | API | DB | 画面 | コンポ (有効) | 連携 | 状態遷移 | フォーム | チャート | テーブル | 小計 |
|------|-----|-----|------|-------------|------|---------|---------|---------|---------|------|
| 勤怠記録 | 7.0 | 6.3 | 6.0 | 9.45 (31.5) | 4.0 | 1.8 | 0.6 | 2.0 | 1.0 | 38.15 |
| 残業申請 | 3.0 | 4.0 | 4.0 | 8.1 (27.0) | 4.0 | 1.8 | 0.6 | 3.0 | 0.5 | 29.0 |
| 有給残高 | 3.0 | 5.5 | 4.0 | 10.8 (36.0) | 4.0 | 1.2 | 0.0 | 0.0 | 1.0 | 29.5 |
| 月次締め | 3.0 | 4.5 | 4.0 | 8.55 (28.5) | 4.0 | 1.5 | 0.0 | 0.0 | 0.5 | 26.05 |
| **合計** | **16.0** | **20.3** | **18.0** | **36.9** | **16.0** | **6.3** | **1.2** | **5.0** | **3.0** | **122.7** |

> コンポーネント有効化率: 0.5
> （ツリーノード 246 × 有効化率 0.5 = 有効コンポーネント 123.0）

---

## メトリクス詳細

### API メトリクス（信頼度: ⭐⭐⭐⭐⭐）

| 集約 | エンドポイント数 | エラーコード数 | 認可パターン数 |
|------|---------------|-------------|-------------|
| 勤怠記録 | 14 | 51 | 14 |
| 残業申請 | 6 | 28 | 6 |
| 有給残高 | 6 | 20 | 6 |
| 月次締め | 6 | 31 | 6 |
| **合計** | **32** | **130** | **32** |

### DB メトリクス（信頼度: ⭐⭐⭐⭐）

| 集約 | エンティティ数 | カラム数 | 制約数 | インデックス数 | ビュー数 |
|------|-------------|--------|--------|-------------|--------|
| 勤怠記録 | 3 | 33 | 19 | 10 | 2 |
| 残業申請 | 2 | 20 | 11 | 10 | 2 |
| 有給残高 | 3 | 25 | 15 | 8 | 2 |
| 月次締め | 2 | 25 | 13 | 6 | 1 |
| **合計** | **10** | **103** | **58** | **34** | **7** |

### 画面 メトリクス（信頼度: ⭐⭐⭐）

| 集約 | 画面数 | コンポーネント数 | 有効コンポーネント数 | チャート数 | テーブル数 | フォーム数 |
|------|--------|-------------|---------------|---------|---------|---------|
| 勤怠記録 | 3 | 63 | 31.5 | 2 | 2 | 2 |
| 残業申請 | 2 | 54 | 27.0 | 3 | 1 | 2 |
| 有給残高 | 2 | 72 | 36.0 | 0 | 2 | 0 |
| 月次締め | 2 | 57 | 28.5 | 0 | 1 | 0 |
| **合計** | **9** | **246** | **123.0** | **5** | **6** | **4** |

### ドメイン メトリクス（信頼度: ⭐⭐⭐）

| 集約 | 状態数 | 遷移数 |
|------|--------|--------|
| 勤怠記録 | 5 | 6 |
| 残業申請 | 6 | 6 |
| 有給残高 | 4 | 4 |
| 月次締め | 5 | 5 |
| **合計** | **20** | **21** |

### コンテキスト間連携メトリクス

| パターン | 件数 |
|---------|------|
| 同期サービス呼び出し | 3 |
| ドメインイベント | 3 |
| Sagaオーケストレーション | 2 |
| **合計** | **8** |

---

## 補正係数

### A. 設計品質係数（加法合成・自動算出）

| 項目 | Δ値 | 算出根拠 |
|------|-----|---------|
| 設計完成度 | -0.1 | design-review 91.7% >= 80% |
| エラー密度 | +0.2 | min(0.2, 4.06 * 0.05) = min(0.2, 0.2) |
| **品質係数** | **1.1** | 1.0 + (-0.1) + 0.2 |

> **除外済み項目（二重計上防止）:**
> - 状態遷移複雑度 → 基本工数の `state_transition` で計上済み
> - 連携複雑度 → 基本工数の `context_integration` で計上済み

### B. スコープ係数（クライアント要件・estimate-config.yaml）

| 項目 | 選択値 | 係数 |
|------|--------|------|
| リアルタイム | なし | 1.0 |
| 国際化 | 単一言語 | 1.0 |
| テストレベル | +統合テスト | 1.0 |
| **合成値** | | **1.0** |

> **除外済み項目（開発チーム内部の技術選定）:**
> - アーキテクチャ（CRUD/DDD/ES+CQRS）
> - フロントエンド構成（テンプレート/SPA/SSR）
> - 認証方式（セッション/OAuth2）
>
> これらのリスクは `team_factors.tech_proficiency` で吸収する。

### C. チーム係数（estimate-config.yaml）

| 項目 | 値 | 備考 |
|------|-----|------|
| 技術習熟度 | 1.0 | 標準的な習熟度 |
| ドメイン知識 | 1.0 | 標準的な知識 |
| チーム規模オーバーヘッド | 1.0 | 1〜3名 |
| **合成値** | **1.0** | |

### 補正係数合成

| 係数 | 値 |
|------|-----|
| A × B × C | 1.1 |
| 安全弁適用後 | **1.1**（安全弁: 5.0） |

---

## 前提条件

- 技術スタック: Next.js 16.x (SSR+SPA) + Spring Boot 4.x (DDD) + PostgreSQL 16.x
- 対象範囲: 4集約（勤怠記録・残業申請・有給残高・月次締め）+ コンテキスト間連携8件
- 設計書完成度: Phase 3 + Phase 3.5 完了（design-review 91.7%）
- 見積もり単価: estimate-config.yaml の unit_prices に基づく
- コンポーネント有効化率: 0.5（ツリーノードの50%を実装対象と算定）

---

## 除外事項

- インフラ構築・運用（AWS ECS Fargate、RDS等）
- CI/CDパイプライン構築（GitHub Actions）
- 外部サービス連携のアカウント発行・契約（Google Workspace OAuth設定等）
- データ移行
- ユーザー教育・マニュアル作成
- プロジェクトマネジメント工数

---

## 再見積もり条件

以下の変更が発生した場合、`/estimate` の再実行を推奨:

- エンドポイント数の増減（±20%以上）
- 新規コンテキストの追加
- チーム構成の変更
- 要件の大幅な変更（集約の追加・削除）
- リアルタイム・多言語・テストレベル等のスコープ要件変更
