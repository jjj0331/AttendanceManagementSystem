# セッション1 会話記録 - 基本フロー抽出

**実施日時**: 2026-02-07
**参加者**: ドメインエキスパート、モデリングアシスタント
**セッション目的**: 勤怠管理の基本業務フローを抽出する
**達成目標**: 主要アクター・コマンド・イベントの特定、基本フロー完成度70%以上

---

## Phase 1: 業務概要ヒアリング（10分）

**【モデリングアシスタント】**
> 勤怠管理の全体的な流れを教えてください。1日のライフサイクルを時系列で、関わるアクターは誰がいますか？

**【ドメインエキスパート】**
> 基本的な1日の流れは、出勤打刻→業務→休憩開始打刻→休憩終了打刻→業務→退勤打刻です。残業がある場合は事前に残業申請を上長に提出し、承認を得てから残業します。月末に人事が締め処理を行い、給与計算用データを出力します。

> アクターは4種類です。一般従業員が日常の打刻と申請を行い、管理職（上長）が部下の申請承認と勤怠状況の確認をします。人事担当者が全社の勤怠管理・締め処理を担当し、給与担当者が最終的なデータを受け取ります。

**【得られた洞察】**
- 打刻は4種類（出勤・退勤・休憩開始・休憩終了）
- 残業は「事前申請→承認→実施」の流れ
- 月次締めが重要なイベント

---

**【モデリングアシスタント】**
> 最も重要なステップは何ですか？

**【ドメインエキスパート】**
> 打刻と月次締めです。打刻がすべてのデータの起点で、月次締めが出口です。打刻が正確でないと後工程の全てが狂います。あと、残業の上限チェックも重要で、36協定違反は会社にとってリスクなので、超過しそうな段階でアラートを出す必要があります。

**【得られた洞察】**
- 打刻の正確性がシステムの信頼性の基盤
- 36協定チェックは「事後」ではなく「事前アラート」が必要

---

## Phase 2: 主要フロー抽出（30分）

### 打刻管理

**【モデリングアシスタント】**
> 打刻処理について詳しく教えてください。入力と出力は？

**【ドメインエキスパート】**
> 入力は「従業員ID + 打刻種別（出勤/退勤/休憩開始/休憩終了）+ 打刻時刻」です。出力は打刻レコードの登録と、勤怠記録への反映です。1つの勤怠記録は1勤務日に対して1レコードで、その日の全打刻を集約しています。

**【モデリングアシスタント】**
> 打刻を忘れた場合はどうしますか？

**【ドメインエキスパート】**
> 打刻修正申請を出します。「何月何日の出勤を9:00に修正」のような形で、上長承認が必要です。承認なしに修正はできません。監査上のルールです。

**【得られた洞察】**
- 勤怠記録は「1勤務日=1レコード」
- 打刻修正には承認ワークフローが必須

---

### 残業管理

**【モデリングアシスタント】**
> 残業申請のフローを教えてください。

**【ドメインエキスパート】**
> 残業予定がある日は、原則として当日の業務終了前までに残業申請を提出します。申請には「予定残業時間」と「理由」を記載します。上長が承認または却下します。実際の退勤時刻から所定終業時刻を差し引いた時間が実残業時間として記録されます。

**【モデリングアシスタント】**
> 申請なしに残業した場合は？

**【ドメインエキスパート】**
> 事後申請も認めていますが、翌営業日中が期限です。それを過ぎると人事確認が必要になります。いわゆる「サービス残業」は法令上認められないので、申請がなくても退勤打刻が所定終業時刻を超えていたら「未申請残業」としてアラートが上長に飛びます。

**【得られた洞察】**
- 残業は事前申請が原則、事後申請は翌営業日まで
- 未申請残業の自動検知とアラートが必要
- サービス残業防止は法令要件

---

### 休暇管理

**【モデリングアシスタント】**
> 休暇の申請・承認フローを教えてください。

**【ドメインエキスパート】**
> 従業員が休暇申請を提出します。種類は年次有給休暇、半日有給、時間単位有給、特別休暇（慶弔・リフレッシュ等）、欠勤です。上長が承認すると確定し、勤怠カレンダーに反映されます。

**【モデリングアシスタント】**
> 有給の付与ルールは？

**【ドメインエキスパート】**
> 入社日起算で6ヶ月経過後に10日付与。その後は1年ごとに増加して、6.5年以降は年20日が上限です。付与日から2年で時効消滅します。消化順序は古いものから（FIFO）です。年5日の取得義務があり、基準日から1年以内に消化しないと法令違反になります。

**【得られた洞察】**
- 有給付与は入社日起算、テーブルドリブン（勤続年数→付与日数）
- 時効2年、FIFO消化
- 年5日取得義務は法令要件

---

### 月次締め処理

**【モデリングアシスタント】**
> 月次締め処理の流れを教えてください。

**【ドメインエキスパート】**
> 毎月末日が締め日です。まず人事担当者が全従業員の勤怠データを確認します。未打刻・未承認の申請があれば、該当者と上長にリマインドを送ります。全データが揃ったら「仮締め」を実行し、人事が確認後に「本締め」を確定します。本締め後は打刻修正不可です。確定したデータをCSV形式で給与システムにエクスポートします。

**【得られた洞察】**
- 仮締め→確認→本締めの2段階
- 本締め後は修正不可（イミュータブル）
- 給与連携はCSVエクスポート

---

## Phase 3: 基本要素整理（15分）

**確認チェックリスト:**
- [x] 主要アクター: 従業員、管理職、人事担当者、給与担当者
- [x] 重要なイベント: 打刻された、残業申請された、休暇申請された、月次締めされた
- [x] コマンド: 打刻する、残業申請する、休暇申請する、承認する、月次締めする
- [x] 基本的なデータフロー: 打刻→勤怠記録→月次締め→CSVエクスポート
- [x] 明らかな矛盾や欠落: なし

---

## Phase 4: 品質チェック（5分）

| 項目 | 達成度 |
|------|--------|
| 基本業務フロー | 75% |
| 例外処理 | 30%（次セッション） |
| 業務ルール | 50%（数値化途中） |

## ホットスポット

1. シフト勤務（日勤/夜勤/フレックス）の勤務時間計算ルール
2. 36協定の段階的アラートの具体的な閾値と通知先
3. 半日有給・時間単位有給の取得単位と残日数計算
4. 打刻修正の承認フローの詳細（差し戻し、再申請）
5. 夜勤（日跨ぎ）の勤務日判定ロジック
