# セッション3 会話記録 - 外部システム連携・統合

**実施日時**: 2026-02-07
**参加者**: ドメインエキスパート、モデリングアシスタント
**セッション目的**: 外部システム連携、コンテキスト境界の確認、最終品質チェック
**達成目標**: 外部連携75%以上、コンテキスト境界の確定

---

## Phase 1: 外部システム連携抽出（30分）

**【モデリングアシスタント】**
> 勤怠管理で連携する外部システムを教えてください。

**【ドメインエキスパート】**
> 主に3つです。
>
> 1. **給与システム**: 月次締め後にCSVで勤怠実績データ（勤務日数、残業時間、有給消化日数等）をエクスポート。現在は手動アップロードですが、将来的にはAPI連携したい。出力のみ。
>
> 2. **Google Workspace**: 認証（SSO）とカレンダー連携。カレンダーに休暇予定を自動反映したい。双方向。
>
> 3. **Slack**: アラート通知の送信先。36協定の段階的アラート、承認リマインド、打刻忘れ通知など。出力のみ。

**【モデリングアシスタント】**
> 給与システムが停止した場合の代替手段は？

**【ドメインエキスパート】**
> CSV出力はローカルに保存されるので、給与システムの復旧後にアップロードし直すだけです。勤怠側への影響はありません。ただし、締め日から給与計算開始日（翌月5日）までに連携が完了しないと給与支払いに影響するので、締め翌営業日中には完了させる運用です。

**【得られた洞察】**
- 給与連携: CSVエクスポート（出力のみ）、将来API化
- Google: SSO + カレンダー同期（双方向）
- Slack: 通知送信（出力のみ）
- 給与連携のSLA: 締め翌営業日中

---

**【モデリングアシスタント】**
> Google カレンダーとの同期で競合が起きた場合は？

**【ドメインエキスパート】**
> 勤怠システムがマスターです。カレンダー上で休暇予定を削除しても、勤怠システム側の休暇承認は取り消されません。同期は勤怠→カレンダーの一方向プッシュで、カレンダー→勤怠の逆方向はありません。

**【得られた洞察】**
- 勤怠システムがマスター、カレンダー同期は一方向プッシュ
- 実質「出力のみ」（双方向ではなかった）

---

## Phase 2: コンテキスト境界の確認（20分）

**【モデリングアシスタント】**
> 業務を大きく分けると、どのような領域がありますか？

**【ドメインエキスパート】**
> 大きく分けると4つの領域があります。
>
> 1. **勤怠管理**（コア）: 打刻、勤怠記録の管理、勤務時間の計算。これがシステムの中心です。
>
> 2. **申請承認**（コア）: 残業申請、休暇申請、打刻修正申請の各種ワークフロー。上長承認のルールはここに集約されます。
>
> 3. **休暇管理**（コア）: 有給の付与・消化・時効管理、特別休暇の管理。付与ルールが複雑なのでドメインロジックが濃い領域です。
>
> 4. **月次処理**（支援）: 月次の締め処理、給与データのエクスポート。勤怠記録を集計して確定する支援的な領域です。

**【モデリングアシスタント】**
> シフト管理は独立した領域ですか？

**【ドメインエキスパート】**
> いえ、シフト管理は勤怠管理コンテキストの中のサブ機能です。シフトパターンの定義と従業員への割当を管理しますが、あくまで勤怠記録の「所定勤務時間」を決定するためのマスタデータです。

**【モデリングアシスタント】**
> 通知（Slack連携等）はどの領域に属しますか？

**【ドメインエキスパート】**
> 通知は汎用的な機能で、どの領域からも使います。独立した共通機能として扱うのが良いと思います。

**【得られた洞察】**
- コア: 勤怠管理、申請承認、休暇管理
- 支援: 月次処理
- 汎用: 通知
- シフト管理は勤怠管理コンテキスト内のサブ機能

---

**【モデリングアシスタント】**
> 領域間のデータ連携を教えてください。

**【ドメインエキスパート】**
> - 勤怠管理→月次処理: 勤怠記録（確定前データ）を渡す
> - 申請承認→勤怠管理: 承認結果を勤怠記録に反映（打刻修正、残業確定）
> - 申請承認→休暇管理: 休暇承認結果を残日数に反映
> - 休暇管理→勤怠管理: 休暇日の勤怠記録を「有給」等のステータスで生成
> - 各領域→通知: イベント発生時に通知依頼

**【得られた洞察】**
- 申請承認が勤怠管理と休暇管理の両方に影響する重要なハブ
- 休暇と勤怠は双方向に連携

---

## Phase 3: 最終品質チェック（10分）

**80%品質基準最終確認:**

- [x] 基本業務フロー: 95%（打刻→申請→承認→締め→エクスポートの全フロー）
- [x] 例外処理: 85%（打刻忘れ、承認遅延、システム障害対応）
- [x] 業務ルール: 90%（36協定閾値、有給付与テーブル、割増率すべて数値化）
- [x] 外部システム連携: 80%（給与CSV、Google SSO/カレンダー、Slack通知）
- [x] データ制約: 85%（本締め後不可変、有給時効2年、時間単位上限40h/年）
- [x] ホットスポット: 0個
