# 技術スタック

## システム構成

### アーキテクチャスタイル

| 項目 | 内容 |
|------|------|
| スタイル | monolith |
| 選定理由 | 従業員500名規模の社内システム。マイクロサービスほどの分散は不要。モジュラーモノリスで将来の分割余地を残す |

### レイヤー構成

    ┌─────────────────────────────────────┐
    │         Presentation Layer          │
    │   (Next.js / API Controllers)       │
    ├─────────────────────────────────────┤
    │         Application Layer           │
    │   (Use Cases / Application Services)│
    ├─────────────────────────────────────┤
    │           Domain Layer              │
    │   (Entities / Domain Services)      │
    ├─────────────────────────────────────┤
    │        Infrastructure Layer         │
    │   (PostgreSQL / External APIs)      │
    └─────────────────────────────────────┘

レイヤー: Presentation / Application / Domain / Infrastructure

---

## 技術スタック詳細

### フロントエンド

| 項目 | 内容 |
|------|------|
| 技術 | Next.js (React) |
| バージョン | Next.js 16.x / React 19.x |
| 選定理由 | SSR/SSGによる初期表示速度、App Routerによるファイルベースルーティング、TypeScriptとの親和性 |

### バックエンド

| 項目 | 内容 |
|------|------|
| 技術 | Spring Boot (Java) |
| バージョン | Spring Boot 4.x / Java 25 |
| 選定理由 | DDDパターンとの高い親和性、豊富なエンタープライズ実績、Spring Securityによる認証認可の充実、長期LTSサポート |

### データベース

| 項目 | 内容 |
|------|------|
| 技術 | PostgreSQL |
| バージョン | PostgreSQL 16.x |
| 選定理由 | 日時・期間計算の組み込みサポート（interval, tstzrange）、JSONBによる柔軟な拡張、実績のある安定性 |

---

## 認証方式

| 項目 | 内容 |
|------|------|
| 認証方式 | JWT |
| OAuthプロバイダー | Google Workspace |

### 認証フロー

JWT ベースの認証フローを採用。Google Workspace の OAuth 2.0 を利用した SSO で、社内アカウントでのシングルサインオンを実現する。アクセストークン（15分）とリフレッシュトークン（7日）の二段構成。

---

## データ戦略

| 項目 | 内容 |
|------|------|
| パターン | standard |
| 選定理由 | 勤怠データは日次更新が中心で、Event Sourcing ほどの複雑さは不要。打刻ログはイミュータブル（追記のみ）、勤怠サマリーはミュータブルで管理 |

### パターン説明

| パターン | 説明 |
|---------|------|
| standard | 軽量CQRS（同一DB内）。エンティティ単位でイミュータブル/ミュータブルを選択可能 |
| event-sourcing | 完全 Event Sourcing。全エンティティがイベント駆動 |

※ エンティティごとのデータモデル（イミュータブル/ミュータブル）は `/db-design` 実行時に決定

---

## インフラストラクチャ

| 項目 | 内容 |
|------|------|
| クラウドプロバイダー | AWS |
| デプロイ方式 | ECS Fargate（コンテナ） |
| CI/CD | GitHub Actions |

---

## API方針

| 項目 | 内容 |
|------|------|
| スタイル | REST |
| バージョニング | URL (/api/v1/) |

### エンドポイント命名規則

- ベースURL: `/api/v1/`
- リソース名: 複数形（例: `/attendances`, `/leaves`）
- ネスト: 最大2階層まで（例: `/employees/{id}/attendances`）

---

## 関連ドキュメント

- [プロジェクト概要](../20_ドメイン/プロジェクト概要.md)

<!-- 品質チェック結果
- [x] アーキテクチャスタイルと選定理由が記載
- [x] 全レイヤーの技術・バージョン・選定理由がある
- [x] 認証フローが具体的
- [x] データ戦略のパターンと理由が明確
- [x] インフラ構成がプロジェクト規模に適合
- [x] API命名規則が定義されている
-->
